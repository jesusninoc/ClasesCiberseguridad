# 3. Seguridad L√≥gica

---------------
---------------
## Usuarios
* V√≠deo sobre c√≥mo instalar Cain & Abel https://www.youtube.com/watch?v=My_X6_Jbwp0
* V√≠deo sobre c√≥mo ver usuarios del Directorio Activo desde Cain & Abel https://www.youtube.com/watch?v=a4xPdwrnK_I
* Enlace para descargar Cain & Abel https://github.com/jesusninoc/Cain/tree/master
* Crear hashes NT4 https://www.jesusninoc.com/01/27/creacion-de-hashes-de-contrasena-nt4/
* Diccionario https://github.com/JorgeDuenasLerin/diccionario-espanol-txt/blob/master/0_palabras_todas.txt
---------------
---------------

La **seguridad l√≥gica** es el conjunto de medidas, controles y pol√≠ticas que protegen los sistemas inform√°ticos frente a accesos no autorizados, manipulaci√≥n de datos o p√©rdidas de informaci√≥n. A diferencia de la seguridad f√≠sica, que protege los equipos y dispositivos, la seguridad l√≥gica se centra en los mecanismos digitales y de software que garantizan la integridad, confidencialidad y disponibilidad de la informaci√≥n.

---

## d) Pol√≠ticas de almacenamiento

Las **pol√≠ticas de almacenamiento** determinan c√≥mo se guarda, clasifica y protege la informaci√≥n dentro de una organizaci√≥n.  
Sus objetivos son:
- Garantizar la **confidencialidad y disponibilidad** de los datos.
- Definir los **niveles de acceso** y el **ciclo de vida** de la informaci√≥n.
- Establecer procedimientos para el **borrado seguro** de datos sensibles.

Una buena pol√≠tica de almacenamiento asegura que los datos se gestionen de forma eficiente y conforme a las normativas de protecci√≥n de datos.

---

## e) Copias de seguridad e im√°genes de respaldo

Las **copias de seguridad** (backups) y las **im√°genes de respaldo** son medidas esenciales para la **recuperaci√≥n ante desastres**.  
Permiten restaurar el sistema o los datos en caso de fallos, ataques o errores humanos.  
Tipos comunes:
- **Copias completas:** guardan todos los datos.
- **Copias incrementales:** solo los cambios desde la √∫ltima copia.
- **Im√°genes de respaldo:** replican un sistema completo, incluyendo el sistema operativo y configuraciones.  

Es fundamental definir una **frecuencia de respaldo** y almacenar las copias en ubicaciones seguras, preferiblemente fuera del sitio principal o en la nube.

---

## f) Medios de almacenamiento

Los **medios de almacenamiento** son los dispositivos f√≠sicos o virtuales donde se guardan los datos.  
Ejemplos:
- Discos duros (HDD, SSD)
- Unidades √≥pticas (CD, DVD, Blu-Ray)
- Memorias USB
- Almacenamiento en red (NAS)
- Servicios de almacenamiento en la nube  

La elecci√≥n del medio depende del nivel de seguridad, capacidad, velocidad y durabilidad requeridos.  
Es importante **proteger f√≠sicamente** los medios y aplicar **cifrado** a los dispositivos port√°tiles para evitar fugas de informaci√≥n.

---

> La seguridad l√≥gica no es solo una cuesti√≥n t√©cnica, sino tambi√©n organizacional: requiere concienciaci√≥n, pol√≠ticas claras y una correcta gesti√≥n de los recursos tecnol√≥gicos.

--------------
--------------

# 4. An√°lisis forense en sistemas inform√°ticos

El **an√°lisis forense en sistemas inform√°ticos** es una disciplina especializada dentro de la seguridad inform√°tica dedicada a la **identificaci√≥n, preservaci√≥n, an√°lisis y presentaci√≥n de evidencias digitales** con validez legal.  
Su finalidad es reconstruir los hechos ocurridos durante un incidente de seguridad ‚Äîcomo accesos no autorizados, robo de informaci√≥n o sabotaje‚Äî de manera **objetiva, verificable y admisible** en un proceso judicial o interno.

---

## a) Aplicaci√≥n de metodolog√≠as de an√°lisis forenses

El proceso forense requiere la aplicaci√≥n de **metodolog√≠as rigurosas y estandarizadas** que garanticen la integridad de las evidencias y la trazabilidad de todas las acciones realizadas.  
Entre los marcos m√°s reconocidos se encuentran:

- **NIST (National Institute of Standards and Technology)**
- **DFRWS (Digital Forensic Research Workshop)**
- **ISO/IEC 27037, 27041 y 27042**

### Fases esenciales del an√°lisis forense

1. **Identificaci√≥n del incidente y planificaci√≥n**
   - Determinar el tipo de incidente, los sistemas implicados y el alcance.
   - Elaborar un plan de actuaci√≥n con objetivos, recursos y responsabilidades.
   - Asegurar la **cadena de custodia** desde el inicio.

2. **Preservaci√≥n y adquisici√≥n de evidencias**
   - Realizar copias **bit a bit** de los medios implicados.
   - Utilizar herramientas como `FTK Imager`, `dd`, `Guymager` o `EnCase`.
   - Verificar integridad mediante **hashes (MD5, SHA-1, SHA-256)**.

3. **An√°lisis t√©cnico**
   - Examen del sistema de archivos (recuperaci√≥n de datos borrados, metadatos, temporales).
   - An√°lisis de logs y tr√°fico de red.
   - Revisi√≥n de memoria RAM y procesos activos.
   - Detecci√≥n de *malware* y *rootkits*.
   - Correlaci√≥n temporal de eventos.

   **Herramientas comunes:**  
   `Autopsy / Sleuth Kit`, `Volatility`, `Wireshark`, `X-Ways Forensics`, `Magnet AXIOM`.

4. **Interpretaci√≥n y correlaci√≥n de evidencias**
   - Reconstruir los hechos y establecer secuencias cronol√≥gicas.
   - Determinar actores, acciones y vulnerabilidades explotadas.

5. **Presentaci√≥n y conservaci√≥n de resultados**
   - Elaborar informe t√©cnico estructurado.
   - Archivar evidencias bajo condiciones seguras y trazables.

> El rigor metodol√≥gico es esencial: cualquier alteraci√≥n o p√©rdida de datos puede invalidar las pruebas o comprometer la investigaci√≥n.

---

## b) Documentaci√≥n y elaboraci√≥n de informes de an√°lisis forenses

La **documentaci√≥n** en el an√°lisis forense garantiza la **reproducibilidad del proceso** y la **transparencia de los resultados**.  
Cada acci√≥n debe quedar registrada con fecha, hora, herramienta utilizada, versi√≥n del software y observaciones.

### Estructura del informe forense

1. **Portada y metadatos**
   - Identificaci√≥n del caso, analista responsable, fecha y n√∫mero de expediente.

2. **Resumen ejecutivo**
   - Principales hallazgos y conclusiones en lenguaje claro y no t√©cnico.

3. **Descripci√≥n del incidente y alcance**
   - Contexto, sistemas afectados, objetivos y limitaciones del an√°lisis.

4. **Metodolog√≠a empleada**
   - Procedimientos, herramientas y est√°ndares aplicados.

5. **An√°lisis t√©cnico y evidencias**
   - Resultados detallados con logs, capturas e identificadores hash.
   - Evidencias etiquetadas y referenciadas adecuadamente.

6. **Conclusiones y recomendaciones**
   - Hechos comprobados, causas identificadas y medidas correctivas.

7. **Anexos y cadena de custodia**
   - Formularios, listados de hashes, im√°genes forenses y registros de custodia.

> El informe debe ser **objetivo, preciso y verificable**, evitando opiniones personales.  
> Su prop√≥sito es documentar hechos y proporcionar una base s√≥lida para decisiones t√©cnicas o legales.

---

## Conclusi√≥n

El an√°lisis forense digital combina **conocimiento t√©cnico, metodolog√≠a cient√≠fica y rigor documental**.  
Su correcta aplicaci√≥n permite no solo identificar las causas de un incidente, sino tambi√©n **aportar pruebas v√°lidas y reproducibles** ante cualquier proceso de auditor√≠a o tribunal.

---

### Referencias normativas y gu√≠as recomendadas

- NIST SP 800-86: *Guide to Integrating Forensic Techniques into Incident Response*  
- ISO/IEC 27037: *Directrices para la identificaci√≥n, recolecci√≥n y preservaci√≥n de evidencia digital*  
- ISO/IEC 27042: *An√°lisis e interpretaci√≥n de la evidencia digital*  
- DFRWS Digital Forensics Framework  
- ENISA Guidelines for Digital Forensics

---

## Enlaces
* https://www.incibe.es/ed2026/talento-hacker/academia-hacker/retosdescargables
* https://dnspy.org/
* https://gchq.github.io/CyberChef/
* https://www.youtube.com/watch?v=cIESBxd5SU4

-----------
-----------

# 5. Implantaci√≥n de Mecanismos de Seguridad Activa üõ°Ô∏è

La **Seguridad Activa** se refiere a las medidas proactivas destinadas a **prevenir, detectar y dificultar** que los incidentes de seguridad se materialicen, protegiendo as√≠ la **integridad**, **confidencialidad** y **disponibilidad** de los sistemas.

---

## a) Ataques y Contramedidas en Sistemas Personales

| **Ataque Com√∫n** | **Descripci√≥n Detallada** | **Contramedida (Mecanismo Activo)** |
|------------------|---------------------------|-------------------------------------|
| **Malware (Virus, Gusanos, Troyanos)** | Software malicioso dise√±ado para da√±ar, obtener acceso o interrumpir el funcionamiento del sistema. | Antivirus/Antimalware (protecci√≥n en tiempo real y escaneos peri√≥dicos). **Firewall** (bloqueo de comunicaciones no autorizadas). |
| **Ransomware** | Tipo de malware que cifra los archivos de la v√≠ctima y exige un rescate para liberarlos. | **Backups** frecuentes y externos (regla 3-2-1). Actualizaci√≥n constante de software. |
| **Phishing / Ingenier√≠a Social** | Fraude por suplantaci√≥n de identidad para que el usuario revele informaci√≥n sensible (contrase√±as, datos financieros). | **Concienciaci√≥n del usuario**, filtros de correo electr√≥nico, verificaci√≥n estricta de la URL y del remitente. |
| **Man-in-the-Middle (MITM)** | Interceptaci√≥n de la comunicaci√≥n entre dos partes para robar o modificar datos (com√∫n en redes Wi-Fi p√∫blicas). | Uso de **VPN** (Red Privada Virtual) para cifrar el tr√°fico. Asegurar que las p√°ginas utilicen **HTTPS**. |
| **Ataque de Fuerza Bruta** | Intentos automatizados de adivinar contrase√±as hasta dar con la correcta. | Uso de **Contrase√±as Robustas**, **Autenticaci√≥n Multifactor (MFA)** y pol√≠ticas de bloqueo tras fallos. |
| **Zero-Day Exploit** | Ataque que aprovecha una vulnerabilidad de software desconocida por el fabricante. | **IDS** (Sistemas de Detecci√≥n de Intrusos) basados en comportamiento. Uso de software de alta reputaci√≥n y an√°lisis heur√≠stico. |

---

## b) Clasificaci√≥n de los Ataques

### Clasificaci√≥n por Objetivo (Impacto en la CIA)

| **Tipo** | **Descripci√≥n** | **Ejemplo** |
|-----------|----------------|--------------|
| **Interrupci√≥n (Disruption)** | Impide el acceso o uso normal del sistema o servicio. | Ataque de **Denegaci√≥n de Servicio (DoS/DDoS)**. |
| **Intercepci√≥n (Interception)** | Acceso no autorizado a la informaci√≥n. | **Sniffing** de red, **Eavesdropping**. |
| **Modificaci√≥n (Modification)** | Alteraci√≥n no autorizada de datos o configuraciones. | **Inyecci√≥n SQL**, **Web Defacement**. |
| **Fabricaci√≥n (Fabrication)** | Creaci√≥n de objetos o datos falsos. | **Inserci√≥n de registros falsos**, **Pharming**. |

### Clasificaci√≥n por M√©todo

| **Categor√≠a** | **Descripci√≥n** |
|----------------|----------------|
| **Malware** | Utilizan software malicioso (virus, troyanos, spyware). |
| **Ingenier√≠a Social** | Se basan en la manipulaci√≥n psicol√≥gica del usuario (phishing, vishing, baiting). |
| **Red/Protocolo** | Explotan debilidades en protocolos de comunicaci√≥n o infraestructura de red (port scanning, MITM). |
| **Aplicaciones Web** | Dirigidos a vulnerabilidades en el c√≥digo de las aplicaciones (SQL injection, XSS). |

---

## c) Anatom√≠a de Ataques y An√°lisis de Software Malicioso

### Anatom√≠a de un Ciberataque (Cyber Kill Chain)

Un ataque persistente avanzado sigue una secuencia conocida como **Cadena de Muerte**:

1. **Reconocimiento:** Recolecci√≥n de informaci√≥n sobre el objetivo (IPs, empleados, tecnolog√≠as usadas).
2. **Armamento:** Creaci√≥n o selecci√≥n de un exploit y payload (c√≥digo malicioso).
3. **Entrega (Delivery):** Transmisi√≥n del arma al objetivo (email, USB, sitio web).
4. **Explotaci√≥n:** Ejecuci√≥n del exploit para ganar acceso al sistema.
5. **Instalaci√≥n:** Establecimiento de persistencia (backdoor, modificaci√≥n del registro).
6. **Comando y Control (C2):** Comunicaci√≥n del malware con el servidor del atacante.
7. **Acciones sobre el Objetivo:** Ejecuci√≥n del prop√≥sito final (robo de datos, cifrado, da√±o).

### An√°lisis de Software Malicioso (Malware Analysis)

**Objetivo:** comprender el funcionamiento, origen y prop√≥sito de un c√≥digo malicioso.

**An√°lisis Est√°tico:**
- Examen del c√≥digo binario sin ejecutarlo.
- Revisi√≥n de:
  - **Hashes:** para identificar malware conocido.
  - **Cadenas de texto:** b√∫squeda de URLs, nombres de archivos o claves de registro.
  - **Metadatos:** informaci√≥n del compilador, fecha y funciones importadas.

**An√°lisis Din√°mico:**
- Ejecuci√≥n del malware en un entorno **aislado (sandbox)**.
- Observaci√≥n del comportamiento:
  - **Monitoreo de red:** detecci√≥n de llamadas C2 o intentos de propagaci√≥n.
  - **Monitoreo del sistema:** registro de cambios en archivos, registro y llamadas API.

---

## d) Herramientas Preventivas: Instalaci√≥n y Configuraci√≥n

| **Herramienta** | **Instalaci√≥n y Configuraci√≥n** | **Pr√°ctica Clave** |
|------------------|----------------------------------|--------------------|
| **Firewall (Cortafuegos)** | Habilitar el firewall del sistema o instalar uno dedicado. Configurar para bloquear tr√°fico entrante por defecto. | **Filtrado de paquetes:** definir reglas por puertos e IPs. |
| **Antivirus/Antimalware** | Instalar soluci√≥n reputada (Microsoft Defender, Bitdefender). Escaneo en tiempo real y semanal. | **Actualizaci√≥n de firmas** autom√°tica. |
| **IDS/IPS** | Configurar herramientas como **Snort** o **Suricata** para monitorizar tr√°fico. | **Monitoreo de anomal√≠as** y bloqueo autom√°tico (si IPS). |
| **Parches / Actualizaciones** | Activar actualizaciones autom√°ticas del sistema y software cr√≠tico. | **Gesti√≥n de vulnerabilidades:** reducir la ventana de exposici√≥n. |
| **Autenticaci√≥n Multifactor (MFA)** | Habilitar 2FA/MFA en cuentas sensibles, preferiblemente por app y no por SMS. | **Capa adicional de seguridad** frente a robo de contrase√±as. |

---

## e) Herramientas Paliativas: Instalaci√≥n y Configuraci√≥n

Estas herramientas se orientan a la **recuperaci√≥n y mitigaci√≥n del da√±o** tras un incidente.

| **Herramienta** | **Instalaci√≥n y Configuraci√≥n** | **Pr√°ctica Clave** |
|------------------|----------------------------------|--------------------|
| **Software de Backup** | Configurar copias de seguridad autom√°ticas con soluciones locales o en la nube. | **Regla 3-2-1:** 3 copias, 2 formatos, 1 fuera de la red. |
| **Herramientas de Cifrado** | Cifrado completo del disco o de archivos (BitLocker, FileVault, VeraCrypt). | **Confidencialidad de datos:** ilegibles sin clave. |
| **An√°lisis Forense** | Uso de **Wireshark** u otras herramientas de respuesta a incidentes. | **Respuesta a incidentes:** determinar alcance y causa ra√≠z. |

---

## f) Actualizaci√≥n de Sistemas y Aplicaciones

**Importancia:** las actualizaciones corrigen vulnerabilidades que los atacantes podr√≠an explotar.

**Protocolo de Actualizaci√≥n:**
- **Activar actualizaciones autom√°ticas** del S.O. y software esencial.
- **Parchear software de terceros** (navegadores, plugins, lectores PDF).
- **Desinstalar software obsoleto** sin soporte o sin uso.
- **Estrategia clave:** reducir la *ventana de vulnerabilidad* (tiempo entre el lanzamiento del parche y su instalaci√≥n).

---

## g) Seguridad en la Conexi√≥n con Redes P√∫blicas

Las redes Wi-Fi p√∫blicas son entornos **no confiables** y requieren precauciones:

- **Uso obligatorio de VPN:** cifrar el tr√°fico para evitar ataques MITM.  
- **Verificaci√≥n de red:** evitar redes con nombres sospechosos o abiertas.  
- **Firewall restrictivo:** usar perfil de ‚ÄúRed P√∫blica‚Äù con m√°xima limitaci√≥n.  
- **Desactivar compartici√≥n:** impedir la compartici√≥n de archivos e impresoras.  

---

## h) Pautas y Pr√°cticas Seguras

La **conciencia y disciplina del usuario** constituyen la principal defensa activa.

- **Principio del M√≠nimo Privilegio (PoLP):** usar cuentas est√°ndar y elevar permisos solo cuando sea necesario.  
- **Gesti√≥n centralizada de contrase√±as:** emplear gestores seguros con contrase√±as √∫nicas.  
- **Cuidado con dispositivos externos:** evitar conectar USB o discos de origen desconocido.  
- **Verificaci√≥n de enlaces y descargas:** revisar URLs y descargar solo desde sitios oficiales.  
- **Cierre de sesiones activas:** cerrar sesiones en servicios sensibles, sobre todo en equipos compartidos.  

-----------
-----------

# 6. Seguridad en la Red Corporativa üåê

La **seguridad en la red corporativa** comprende el conjunto de medidas t√©cnicas, organizativas y procedimentales destinadas a proteger la infraestructura de comunicaciones, los datos en tr√°nsito y los servicios de red frente a amenazas internas y externas. Este cap√≠tulo desarrolla tanto medidas preventivas como capacidades de detecci√≥n, respuesta y resiliencia, integrando criterios de arquitectura, gesti√≥n de riesgo y operativa continuada.

---

## 6.1 Monitorizaci√≥n del Tr√°fico en Redes

La **monitorizaci√≥n** es una capacidad activa y continuada que permite la detecci√≥n temprana de anomal√≠as, la correlaci√≥n de eventos y la obtenci√≥n de indicadores de compromiso (IoC). Debe integrarse en un marco de gobernanza que defina responsabilidades (SOC, equipo de red, CISO), niveles de servicio y retenci√≥n de registros.

### 6.1.1 Herramientas y T√©cnicas

- **Captura de paquetes (sniffing):** herramientas como `tcpdump` o `Wireshark` permiten la inspecci√≥n pormenorizada de tramas y flujos. Su uso debe restringirse a entornos controlados y complementarse con anonimizaci√≥n de datos sensibles en entornos productivos.
- **IDS/IPS (Detecci√≥n/Prevenci√≥n de intrusiones):**
  - *IDS:* monitoriza y alerta sobre patrones conocidos (firmas) y anomal√≠as (basado en comportamiento).
  - *IPS:* act√∫a de forma activa bloqueando o mitigando tr√°fico malicioso cuando se cumplen criterios definidos.
  - Ejemplos operativos: reglas de correlaci√≥n para detectar escaneos, patrones C2 o exfiltraci√≥n.
- **SIEM (Gesti√≥n de Eventos e Informaci√≥n de Seguridad):** centraliza logs de firewalls, endpoints, proxies, autenticaci√≥n y aplicaciones. Proporciona normalizaci√≥n, enriquecimiento, correlaci√≥n y generaci√≥n de alertas/triage.
- **Network Flow / NetFlow / sFlow:** agregaci√≥n de metadatos de flujo (origen, destino, bytes, puertos) para an√°lisis a escala y detecci√≥n de transferencias inusuales.
- **An√°lisis de comportamiento (UEBA):** modelos que identifican desviaciones del perfil normal de usuarios o dispositivos (p. ej., accesos fuera de horario, vol√∫menes an√≥malos).
- **Sandboxing / Proxy de contenido:** inspecci√≥n de archivos y tr√°fico para ejecutar y analizar comportamientos potencialmente maliciosos antes de permitir su paso a la red interna.

### 6.1.2 Se√±ales y M√©tricas Clave a Monitorizar

- Conexiones salientes persistentes a direcciones/IPs desconocidas (posible C2).
- Transferencias de datos fuera de los patrones normales (posible exfiltraci√≥n).
- Escaneos de puertos o patrones de descubrimiento interno.
- Incrementos en los logs de autenticaci√≥n fallida (fuerza bruta).
- Aumento s√∫bito del tr√°fico de broadcast/multicast (indicador de lateral movement o worm).
- Tiempo medio de detecci√≥n (MTTD) y tiempo medio de respuesta (MTTR) como KPIs operativos.

### 6.1.3 Retenci√≥n y Protecci√≥n de Registros

- Definir pol√≠ticas de retenci√≥n alineadas con requisitos legales y necesidades forenses (p. ej., 1‚Äì2 a√±os para ciertos logs).
- Asegurar integridad y disponibilidad de registros (almacenamiento inmutable, replicaci√≥n).
- Control de acceso basado en roles para evitar manipulaci√≥n de evidencias.

---

## 6.2 Seguridad en Protocolos para Comunicaciones Inal√°mbricas

Las redes inal√°mbricas requieren una estrategia de seguridad que combine robustez criptogr√°fica, autenticaci√≥n centralizada y segmentaci√≥n.

### 6.2.1 Estado y Recomendaciones de Protocolos Wi-Fi

| **Protocolo** | **Estado** | **Riesgos / Comentario** | **Recomendaci√≥n** |
|---------------|------------|--------------------------|-------------------|
| **WEP** | Obsoleto | Vulnerable a ataques por reutilizaci√≥n de IVs | Prohibir su uso. |
| **WPA / WPA-Personal (PSK)** | Insuficiente para entornos corporativos | Vulnerable a ataques offline si la contrase√±a es d√©bil | Migrar a WPA2/3 Enterprise. |
| **WPA2-Enterprise (802.1X + AES)** | Est√°ndar m√≠nimo aceptable | Requiere gesti√≥n de RADIUS y certificados | Implementar con EAP-TLS o EAP-PEAP seg√∫n pol√≠tica. |
| **WPA3 (SAE, cifrado individualizado)** | Recomendado | Mejora resistencia a ataques offline y protege en redes abiertas | Adoptar en despliegues nuevos; evaluar compatibilidad de clientes. |

### 6.2.2 Autenticaci√≥n y Gesti√≥n

- **802.1X + RADIUS:** centraliza la autenticaci√≥n de usuarios y dispositivos. Preferir EAP-TLS (mutua basada en certificados) para mayor seguridad.
- **Gesti√≥n de certificados:** pol√≠ticas de ciclo de vida, revocaci√≥n (CRL/OCSP) y distribuci√≥n segura para clientes y puntos de acceso.
- **Redes de invitados:** segmentaci√≥n estricta mediante VLANs y reglas de firewall que limiten el acceso a recursos internos; aplicar QoS y limitaci√≥n de ancho de banda.

### 6.2.3 Buenas Pr√°cticas

- Actualizar firmware de APs y controladoras peri√≥dicamente.
- Desactivar WPS y otros mecanismos de configuraci√≥n f√°cil que reducen seguridad.
- Monitorizar APs no autorizados (rogue AP detection) y bloquear los que representen riesgo.

---

## 6.3 Riesgos Potenciales de los Servicios de Red y Hardening

Los servicios que soportan la operativa (DNS, Web, SSH, correo) son vectores cr√≠ticos. Su endurecimiento debe seguir un proceso sistem√°tico.

### 6.3.1 Servicios Cr√≠ticos: Riesgos y Mitigaciones

| **Servicio** | **Funci√≥n** | **Riesgos** | **Medidas de Mitigaci√≥n** |
|--------------|-------------|-------------|---------------------------|
| **DNS** | Resoluci√≥n de nombres | Spoofing, cache poisoning, hijacking | Implementar DNSSEC, servidores autoritativos redundantes, controles de acceso, monitoreo de cambios de zona. |
| **HTTP/HTTPS** | Entrega de aplicaciones web | Inyecci√≥n SQL, XSS, sesiones comprometidas | WAF, an√°lisis SAST/DAST en SDLC, HSTS, TLS fuerte y renovaci√≥n de certificados. |
| **SSH / RDP** | Acceso remoto | Fuerza bruta, credenciales comprometidas | MFA, autenticaci√≥n por claves, restringir por IP, bastion hosts, rotaci√≥n de claves. |
| **Correo (SMTP/IMAP/POP3)** | Mensajer√≠a empresarial | Phishing, spam, malware | Gateways antispam/antimalware, DMARC/SPF/DKIM, sandboxing adjuntos. |
| **NTP / SNMP** | Servicios de sincronizaci√≥n/gesti√≥n | Manipulaci√≥n de tiempo, exposici√≥n de MIBs | Restringir acceso, usar versiones seguras (SNMPv3), verificar integridad temporal. |

### 6.3.2 Proceso de Hardening (Endurecimiento)

1. **Inventario y clasificaci√≥n:** identificar servicios, versiones y exposici√≥n en la red.
2. **Desactivar servicios innecesarios** y cerrar puertos no usados.
3. **Cambiar puertos por defecto** cuando proceda (no como √∫nica medida).
4. **Aplicar Principio del M√≠nimo Privilegio** a cuentas de servicio y procesos.
5. **Configurar logging detallado** y env√≠o a SIEM.
6. **Automatizar parches** y validar mediante pruebas de regresi√≥n.
7. **Verificaci√≥n y auditor√≠a peri√≥dica** (scans de vulnerabilidades, configuraciones CIS benchmarks).

---

## 6.4 Penetration Testing (Pruebas de Penetraci√≥n)

Las pruebas de penetraci√≥n son ejercicios controlados que validan la efectividad de controles y procedimientos.

### 6.4.1 Fases Operativas de un Pen Test

1. **Planificaci√≥n y alcance:** definir activos, l√≠mites, criterios de √©xito y aspectos legales (autorizaciones).
2. **Reconocimiento:** recopilaci√≥n pasiva y activa (OSINT, enumeraci√≥n).
3. **Escaneo y enumeraci√≥n:** usar `Nmap`, `Masscan`, fingerprinting de servicios.
4. **Explotaci√≥n:** aprovechamiento de vulnerabilidades identificadas con herramientas y exploits controlados.
5. **Privilegio y movimiento lateral:** evaluar capacidad de escalado y persistencia.
6. **Exfiltraci√≥n simulada:** comprobar detecci√≥n de filtrado de datos.
7. **Reporte y remediaci√≥n:** informe t√©cnico y ejecutivo, priorizaci√≥n por riesgo y gu√≠as de mitigaci√≥n.
8. **Validaci√≥n post-remediaci√≥n:** re-test para verificar cierre de vector.

### 6.4.2 Tipos de Pruebas

- **Caja Negra (Black Box):** sin conocimiento previo; simula atacante externo.
- **Caja Gris (Grey Box):** con credenciales limitadas; eval√∫a amenaza de usuario comprometido.
- **Caja Blanca (White Box):** con acceso total a documentaci√≥n y c√≥digo; permite pruebas exhaustivas.

### 6.4.3 Aspectos Legales y √âticos

- Obtener **autorizaci√≥n escrita** del propietario de la infraestructura.
- Definir ventanas de ejecuci√≥n, mecanismos de detenci√≥n ante impacto y responsables de comunicaci√≥n.
- Proteger datos personales durante las pruebas y cumplir normativa aplicable (protecci√≥n de datos).

---

## 6.5 Arquitectura, Segmentaci√≥n y Modelo Zero-Trust

La arquitectura de red determina la capacidad de contenci√≥n y resiliencia ante incidentes.

### 6.5.1 Segmentaci√≥n y Zonas de Confianza

- **Separaci√≥n en VLANs/subredes** seg√∫n funci√≥n (producci√≥n, gesti√≥n, invitados, OT).
- **Firewalls internos** y pol√≠ticas de control de acceso Este-Oeste para limitar movimiento lateral.
- **Bastion Hosts** y jump servers para accesos administrativos.

### 6.5.2 Microsegmentaci√≥n y Pol√≠ticas Basadas en Identidad

- Adoptar microsegmentaci√≥n en centros de datos y entornos virtualizados para aplicar pol√≠ticas por aplicaci√≥n/servicio.
- Integrar controles con sistemas de orquestaci√≥n y gesti√≥n de identidades para pol√≠ticas din√°micas.

### 6.5.3 Modelo Zero-Trust

- Verificar continuamente identidad, integridad del dispositivo y contexto antes de conceder acceso.
- Aplicar controles m√≠nimos de acceso (least privilege) y supervisi√≥n continua.

---

## 6.6 Resiliencia Operativa: Respuesta a Incidentes y Forensic Readiness

La preparaci√≥n para incidentes reduce el impacto y acelera la recuperaci√≥n.

### 6.6.1 Integraci√≥n con el Plan de Respuesta a Incidentes (IR)

- Definir **playbooks** por escenario (ransomware, fuga de credenciales, DDoS).
- Establecer un **SOC** o contrato con MSSP que cubra monitorizaci√≥n 24/7 y escalado.
- Simulacros peri√≥dicos (tabletop exercises) para validar procesos y comunicaci√≥n.

### 6.6.2 Forensic Readiness

- Asegurar recolecci√≥n, preservaci√≥n e integridad de artefactos (memoria, discos, logs).
- Definir puntos de captura y herramientas aprobadas para an√°lisis forense.
- Coordinar con legal y comunicaciones antes de acciones que puedan afectar evidencia.

### 6.6.3 Continuidad de Negocio y Recuperaci√≥n (BC/DR)

- Planificar recuperaci√≥n por niveles (RTO/RPO) para servicios cr√≠ticos.
- Practicar restauraciones desde backups en entornos controlados.
- Conservar copias externas y desconectadas de sistemas cr√≠ticos (air-gapped backups).

---

## 6.7 Gobernanza, Cumplimiento y Formaci√≥n

La seguridad de red requiere un marco de gobernanza que alinee riesgos y controles con la estrategia empresarial.

- **Pol√≠ticas y procedimientos** actualizados: control de cambios, gesti√≥n de vulnerabilidades, gesti√≥n de cuentas.
- **Auditor√≠as y pruebas peri√≥dicas** (internas y externas).
- **Concienciaci√≥n y formaci√≥n continua** para administradores de red y usuarios: reconocimiento de phishing, gesti√≥n de credenciales, pr√°cticas de hardening.
- **Indicadores de riesgo** y reporting al Consejo/Comit√© de Riesgos: m√©tricas operativas (MTTD/MTTR), n√∫mero de incidentes, estado de parches cr√≠ticos.

---

## 6.8 Recomendaciones Ejecutivas (Resumen)

1. **Implementar una arquitectura segmentada** con controles Este-Oeste y pol√≠ticas de microsegmentaci√≥n en servicios cr√≠ticos.  
2. **Adoptar 802.1X (WPA2/3 Enterprise)** para redes inal√°mbricas y gesti√≥n centralizada de certificados.  
3. **Desplegar SIEM integrado con IDS/IPS y UEBA** para correlaci√≥n y detecci√≥n avanzada.  
4. **Formalizar proceso de hardening y parcheo** automatizado con validaci√≥n de despliegue.  
5. **Realizar Pen Tests regulares** con alcance definido y re-tests tras remediaci√≥n.  
6. **Preparar planes de respuesta y forensic readiness**, con backups off-site y simulacros de recuperaci√≥n.  
7. **Medir y reportar KPIs** (MTTD, MTTR, % parches aplicados, n√∫mero de incidentes cr√≠ticos) para gobernanza.

---

## 6.9 Ap√©ndice ‚Äî Herramientas y Referencias Operativas (ejemplos)

> *Nota:* la lista indica categor√≠as y ejemplos operativos; su elecci√≥n depender√° del contexto organizativo, presupuesto y requisitos regulatorios.

- **Captura/An√°lisis de paquetes:** Wireshark, tcpdump.  
- **IDS/IPS:** Snort, Suricata, Zeek.  
- **SIEM / Log management:** soluciones comerciales y open-source seg√∫n necesidades.  
- **Escaneo y pen testing:** Nmap, Nessus, OpenVAS, Metasploit, Burp Suite.  
- **Forense y respuesta:** Volatility, Autopsy, FTK, herramientas de EDR/endpoint.  
- **Gesti√≥n de acceso y autenticaci√≥n:** RADIUS/FreeRADIUS, soluciones de identidad empresarial y MFA.  

-----------
-----------

# 7. Implantaci√≥n de T√©cnicas de Acceso Remoto y Seguridad Perimetral üõ°Ô∏è

La **seguridad perimetral** constituye la primera l√≠nea de defensa de la infraestructura corporativa. Su objetivo es controlar el tr√°fico que entra y sale de la organizaci√≥n, garantizando que los accesos remotos se realicen de forma segura, autenticada y trazable.  
En un entorno donde el teletrabajo, la movilidad y los servicios en la nube son habituales, la frontera de red deja de ser un l√≠mite f√≠sico y pasa a ser un **ecosistema distribuido** que requiere una gesti√≥n integral de seguridad.

---

## a) Elementos B√°sicos de la Seguridad Perimetral

La seguridad perimetral protege el l√≠mite entre la red interna confiable y las redes externas no confiables (como Internet).  
Se apoya en una arquitectura en capas que combina controles t√©cnicos, l√≥gicos y de acceso.

### üîë Componentes principales

- **Firewall (Cortafuegos):**  
  Act√∫a como n√∫cleo de la defensa perimetral, aplicando pol√≠ticas de filtrado basadas en IP, puertos, protocolos y aplicaciones.  
  **Tipos principales:**  
  - *Filtrado de paquetes:* opera a nivel de red.  
  - *Stateful Inspection:* analiza el estado de las conexiones.  
  - *Firewalls de Pr√≥xima Generaci√≥n (NGFW):* inspecci√≥n profunda (DPI), filtrado por aplicaci√≥n y detecci√≥n de intrusiones.

- **Routers y Switches Seguros:**  
  Configurados con *Listas de Control de Acceso (ACLs)* para limitar el tr√°fico y restringir conectividad entre subredes.

- **IDS/IPS (Intrusion Detection/Prevention Systems):**  
  Analizan el tr√°fico en busca de firmas o comportamientos maliciosos.  
  - *IDS:* genera alertas.  
  - *IPS:* bloquea autom√°ticamente el tr√°fico sospechoso.

- **Puertas de Enlace VPN (VPN Gateways):**  
  Gestionan las conexiones cifradas y la tunelizaci√≥n segura de usuarios remotos.

- **Filtrado de Contenido / Proxy:**  
  Analizan el tr√°fico web y de correo electr√≥nico para bloquear malware, spam o accesos no autorizados.

---

## b) Per√≠metros de Red y Zonas Desmilitarizadas (DMZ)

El per√≠metro de red se divide en **zonas l√≥gicas de seguridad**, cada una con un nivel distinto de confianza y exposici√≥n.

| Zona | Descripci√≥n | Nivel de Confianza |
|------|--------------|-------------------|
| **Red Externa (Internet)** | Espacio no controlado, origen potencial de amenazas. | No confiable |
| **Zona Desmilitarizada (DMZ)** | Subred intermedia con servicios p√∫blicos (web, correo, DNS, VPN). | Parcialmente confiable |
| **Red Interna (LAN)** | Contiene datos y sistemas cr√≠ticos, acceso controlado. | Alta confianza |

**Objetivo:**  
Aislar los sistemas p√∫blicos para evitar que un compromiso afecte a la red interna.  
El tr√°fico entre zonas se regula mediante pol√≠ticas espec√≠ficas de firewall y segmentaci√≥n de red.

---

## c) Arquitectura D√©bil de Subred Protegida (DMZ de un Solo Firewall)

Un √∫nico firewall separa tres interfaces:

1. Red Externa (Internet)  
2. DMZ (Servidores P√∫blicos)  
3. Red Interna (LAN)

**Ventajas:**
- Bajo coste de implementaci√≥n.  
- Administraci√≥n sencilla.

**Inconvenientes:**
- Un √∫nico punto de fallo.  
- Si el firewall se compromete, el atacante podr√≠a acceder a toda la red.

---

## d) Arquitectura Fuerte de Subred Protegida (DMZ de Doble Firewall)

Tambi√©n denominada **Per√≠metro en Capas** o **Defensa en Profundidad**.

- **Firewall Perimetral (Front-End):**  
  Conecta Internet con la DMZ. Solo permite tr√°fico a servicios p√∫blicos.
- **Firewall Interno (Back-End):**  
  Conecta la DMZ con la LAN. Es m√°s restrictivo y solo permite tr√°fico necesario (por ejemplo, consultas de base de datos).

**Ventajas:**
- Mayor resiliencia.  
- Segmentaci√≥n y auditor√≠a diferenciada.  
- Configuraci√≥n preferida en entornos cr√≠ticos o de alta seguridad.

---

## e) Redes Privadas Virtuales (VPN)

Las **VPN** son esenciales para el **acceso remoto seguro**, especialmente en modelos de trabajo h√≠brido.

**Concepto:**  
Crean un t√∫nel cifrado sobre una red p√∫blica, garantizando la confidencialidad, integridad y autenticidad de los datos.

### üîí Tipos de VPN

- **VPN de Acceso Remoto (Client-to-Site):**  
  Usuarios individuales se conectan mediante un cliente VPN (OpenVPN, AnyConnect).  
  Ideal para teletrabajo y movilidad.

- **VPN de Sitio a Sitio (Site-to-Site):**  
  Conecta sedes geogr√°ficamente separadas para operar como una √∫nica LAN cifrada.

### ‚öôÔ∏è Protocolos m√°s comunes

| Protocolo | Caracter√≠sticas |
|------------|----------------|
| **IPSec** | Est√°ndar para seguridad en redes IP. Autenticaci√≥n, integridad y cifrado extremo a extremo. Ideal para Site-to-Site. |
| **SSL/TLS** | Utilizado en OpenVPN o AnyConnect. Opera sobre puerto 443, facilitando la conexi√≥n a trav√©s de firewalls. Ideal para acceso remoto. |

---

## f) VPN vs. L√≠neas Dedicadas

| Caracter√≠stica | VPN (sobre Internet) | L√≠neas Dedicadas (MPLS, T1) |
|----------------|----------------------|------------------------------|
| **Coste** | Bajo. Usa infraestructura p√∫blica. | Alto. Circuitos alquilados. |
| **Escalabilidad** | Alta. F√°cil de a√±adir usuarios/sedes. | Baja. Depende del proveedor. |
| **Seguridad** | Alta. Cifrado extremo a extremo. | Media/Alta. Basada en aislamiento f√≠sico. |
| **Rendimiento/QoS** | Variable. Depende del tr√°fico de Internet. | Garantizado mediante SLA. |
| **Uso ideal** | Teletrabajo, movilidad, entornos distribuidos. | Sedes cr√≠ticas con tr√°fico constante. |

**Conclusi√≥n:**  
Las VPN ofrecen una soluci√≥n flexible y segura a menor coste, aunque sacrifican la estabilidad y el rendimiento garantizado de las l√≠neas dedicadas.

---

## g) T√©cnicas de Cifrado üîê

El cifrado es la base de la seguridad en VPN y en la protecci√≥n perimetral.

### Cifrado Sim√©trico (Clave √önica)
- Usa la misma clave para cifrar y descifrar.  
- R√°pido y eficiente.  
- Dificultad: distribuir la clave de forma segura.  
- **Ejemplo:** AES (Advanced Encryption Standard).

### Cifrado Asim√©trico (Par de Claves)
- Usa dos claves:  
  - **P√∫blica:** se distribuye libremente.  
  - **Privada:** debe mantenerse secreta.  
- Permite autenticaci√≥n y no repudio.  
- **Ejemplos:** RSA, ECC (Elliptic Curve Cryptography).

### Cifrado H√≠brido (Combinado)
- El cifrado asim√©trico se usa en el *Handshake* inicial para intercambiar la clave de sesi√≥n.  
- El cifrado sim√©trico cifra los datos posteriores, optimizando seguridad y velocidad.  
- Utilizado en protocolos **TLS/SSL** y **VPNs modernas**.

---

## h) Recomendaciones Avanzadas ‚öôÔ∏è

- Implementar **autenticaci√≥n multifactor (MFA)** para todo acceso remoto.  
- Registrar y auditar continuamente el tr√°fico perimetral y las sesiones VPN.  
- Desplegar sistemas de **detecci√≥n de anomal√≠as (UEBA/NDR)** para identificar comportamientos inusuales.  
- Adoptar pol√≠ticas de **Zero Trust Network Access (ZTNA)**: ning√∫n usuario o dispositivo es confiable por defecto.  
- Revisar y depurar peri√≥dicamente las reglas de firewall y accesos obsoletos.  
- Mantener **actualizaciones y parches de seguridad** en todos los equipos del per√≠metro.

---

‚úÖ **Resumen:**  
La seguridad perimetral moderna combina la segmentaci√≥n de red, el cifrado de extremo a extremo y la autenticaci√≥n robusta para garantizar accesos remotos seguros, controlados y auditables.  
El equilibrio entre protecci√≥n, rendimiento y flexibilidad es clave en la defensa de la red corporativa actual.

-----------
-----------



-----------
-----------
